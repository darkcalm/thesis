\documentclass[11pt,a4paper]{article}
\usepackage[margin=1.5cm]{geometry}
\usepackage{tikz}
\usepackage{xcolor}
\usetikzlibrary{positioning,shapes.geometric,calc}

\begin{document}

\section*{Multi-Level Context Map Generator}
\subsection*{Usage Instructions for Handoff}

\paragraph{Conceptual Framework:}
This visualization uses \textbf{elliptical coordinates} derived from polar coordinates $(r, \phi)$ at each stage to map concepts across abstraction levels. The circular coordinates are transformed into a flat oval shape to provide more horizontal space for text:
\begin{itemize}
    \item \textbf{Radius $r$}: Abstraction level (center = high abstraction, outer rings = lower abstraction/specific implementations)
    \item \textbf{Angle $\phi$}: Aspect or dimension of the central concept
    \item \textbf{Coordinate transformation}: $(r, \phi) \rightarrow (r \cos\phi \cdot s_x, r \sin\phi \cdot s_y)$ where $s_x = 1.4$ (horizontal stretch) and $s_y = 0.8$ (vertical compression) create a flat oval layout
    \item \textbf{Visual style}: Nodes have no borders or backgrounds for a clean, minimal appearance
    \item \textbf{Progression}: Each level zooms into a concept from the previous level, making it the new center
\end{itemize}

\paragraph{How to Extend:}
\begin{enumerate}
    \item \textbf{Add a new level}: Pick any medium-to-low radius concept from the current level
    \item Make it the \textbf{new center} of the next level
    \item Define 6--8 \textbf{aspects} (angular positions) related to this concept
    \item For each aspect, place labels at different \textbf{radii} (abstraction levels):
    \begin{itemize}
        \item Center ($r = 0$): Central concept
        \item Medium radius ($r = 2.6$): Intermediate concepts
        \item Outer radius ($r = 5$): Concrete implementations/specifics
    \end{itemize}
\end{enumerate}

\paragraph{Customization Guide:}
\begin{itemize}
    \item Modify \texttt{\textbackslash drawContextLevel} parameters: center text, petal labels, outer labels
    \item Adjust \texttt{petalRadius} (default: 2.6), \texttt{outerRadius} (default: 5) for sizing
    \item Change \texttt{numPetals} (default: 8) for more/fewer aspects
    \item Adjust \texttt{ellipseStretchX} (default: 1.4) and \texttt{ellipseStretchY} (default: 0.8) to modify the oval shape
    \item Connect levels with curved arrows showing progression
    \item Note: All nodes are borderless and backgroundless by design
\end{itemize}

\vspace{1em}
\hrule
\vspace{1em}

% Define custom command for drawing context levels
\newcommand{\drawContextLevel}[5]{
    % #1 = center x position
    % #2 = center y position
    % #3 = center text
    % #4 = list of petal/bubble labels (comma separated)
    % #5 = list of outer detail labels (comma separated)

    \begin{scope}[shift={(#1,#2)}]
        % Draw center circle (no border, no fill)
        \node[circle, minimum size=2cm, align=center, font=\bfseries\small]
            at (0,0) {#3};

        % Parameters
        \def\petalRadius{2.6}
        \def\outerRadius{5}
        \def\numPetals{8}
        % Elliptical coordinate transformation: horizontal stretch factor
        \def\ellipseStretchX{1.4}
        \def\ellipseStretchY{0.8}

        % Draw petals (medium abstraction bubbles) - no border, no fill
        \foreach \i/\label in {#4} {
            \pgfmathsetmacro{\angle}{360/\numPetals * \i}
            \pgfmathsetmacro{\xpos}{\petalRadius * cos(\angle) * \ellipseStretchX}
            \pgfmathsetmacro{\ypos}{\petalRadius * sin(\angle) * \ellipseStretchY}
            \node[align=center, font=\scriptsize]
                at (\xpos, \ypos) {\label};
        }

        % Draw outer labels (low abstraction - specific details)
        \foreach \i/\label in {#5} {
            \pgfmathsetmacro{\angle}{360/\numPetals * \i}
            \pgfmathsetmacro{\xpos}{\outerRadius * cos(\angle) * \ellipseStretchX}
            \pgfmathsetmacro{\ypos}{\outerRadius * sin(\angle) * \ellipseStretchY}
            \node[align=center, font=\tiny] at (\xpos, \ypos) {\label};
        }
    \end{scope}
}

\begin{center}
\begin{tikzpicture}[scale=0.85]

    % Level 1
    \node[font=\Large\bfseries] at (-6, 5) {Context Level 1};

    \drawContextLevel{0}{0}{100\% Renewable\\World}{
        0/Energy efficiency\\and sufficiency,
        1/Electrification,
        2/Adoption,
        3/Circularity,
        4/Diversification,
        5/Scalability,
        6/Energy\\storage,
        7/Demand\\response
    }{
        0/grid modernization,
        0.5/buildings / appliances,
        1/sharing economy,
        1.5/diet / consumption habits,
        2/policy and mandates,
        2.5/partnerships,
        3/design for circularity,
        3.5/sector coupling,
        4/resource mix,
        4.5/temporal diversity,
        5/manufacturing,
        5.5/installation,
        6/systems,
        6.5/fuels,
        7/implicit,
        7.5/optimizing processes
    }

    % Arrow to Level 2
    \draw[->, ultra thick] (3.5, -3) to[out=-45, in=135] (5, -6);

    % Level 2
    \node[font=\Large\bfseries] at (-6, -6) {Context Level 2};

    \drawContextLevel{0}{-11}{No Material Waste:\\all materials curls\\back to support\\production}{
        0/Policy \& business\\models,
        1/Material\\design,
        2/Product life\\extension,
        3/Reverse\\logistics,
        4/Post use\\collection,
        5/Sorting \&\\preprocessing,
        6/Recycling \&\\reprocessing,
        7/Supply chain\\integration
    }{
        0/circular economy\\regulations,
        0.5/product-as-a-service,
        1/design for disassembly,
        1.5/modular design,
        2/repair services,
        2.5/refurbishment,
        3/collection network,
        3.5/returns management,
        4/curbside collection,
        4.5/drop-off points,
        5/optical sorting,
        5.5/robotic sorting,
        6/chemical recycling,
        6.5/mechanical recycling,
        7/closed-loop supply chains,
        7.5/eco-industrial parks
    }

    % Arrow to Level 3
    \draw[->, ultra thick] (3.5, -14) to[out=-45, in=135] (5, -17);

    % Level 3
    \node[font=\Large\bfseries] at (-6, -17) {Context Level 3};

    \drawContextLevel{0}{-22}{Automated Waste\\Segregation}{
        0/Sense \&\\detection,
        1/Material\\classification,
        2/Actuation\\mechanism,
        3/Integration \&\\control,
        4/Operational\\performance,
        5/Environmental\\performance,
        6/Economic\\viability,
        7/Pre-treatment
    }{
        0/electromagnetic,
        0.5/spectroscopic,
        1/color and visual,
        1.5/polymer type,
        2/picking and grasping,
        2.5/pneumatic ejection,
        3/real-time / latency,
        3.5/multi-stage / cascade,
        4/throughput / capacity,
        4.5/reliability / precision,
        5/emission reduction,
        5.5/energy consumption,
        6/return on investment,
        6.5/economies of scale,
        7/size standardization,
        7.5/contamination removal
    }

\end{tikzpicture}
\end{center}

\vspace{1em}
\hrule
\vspace{0.5em}

\subsection*{Template for Adding Level 4}

\begin{verbatim}
% Choose a concept from Level 3 (e.g., "Material classification")
\drawContextLevel{x-position}{y-position}{Material\\classification}{
    0/Computer\\vision,
    1/Spectral\\analysis,
    2/Machine\\learning,
    3/Database\\systems,
    ... (add 4-8 aspects)
}{
    0/RGB imaging,
    0.5/hyperspectral,
    1/NIR spectroscopy,
    ... (add outer detail labels at various angles)
}
\end{verbatim}

\paragraph{Key Principle:} Each level represents a \textbf{zoom-in operation}â€”taking a specific concept and exploring its constituent aspects and implementation details. The elliptical coordinate structure ensures both breadth (different aspects via angles) and depth (abstraction levels via radius) are captured simultaneously, with the flat oval layout optimized for text readability.

\end{document}
